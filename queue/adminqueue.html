<!doctypehtml><html lang=th><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>จัดการระบบคิว สำนักงานขนส่งจังหวัดชลบุรี สาขาอำเภอศรีราชา</title><meta name=description content="จัดการระบบคิว for LIFF App"><meta name=author content="สำนักงานขนส่งจังหวัดชลบุรี สาขาอำเภอศรีราชา"><meta property=og:title content="จัดการระบบคิว-สำนักงานขนส่งจังหวัดชลบุรี สาขาอำเภอศรีราชา"><meta property=og:description content="จัดการระบบคิว for LIFF App"><meta property=og:type content=website><meta property=og:image content=https://lh3.googleusercontent.com/d/1ISNeCGzi9N0Ark6FJl2L6xgbe-qZujHv><script src=https://cdn.tailwindcss.com></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;700&display=swap"rel=stylesheet><link rel=stylesheet href=https://bit.ly/fontiton5 charset=utf-8><style>:root{--primary:#fcaa67;--secondary:#b0413e;--background:#ffffc7;--accent1:#548687;--accent2:#473335}body{font-family:line_seed_sans_th;background-color:#f0f2f5}.header-gradient{background-image:linear-gradient(120deg,var(--accent2),var(--accent1))}.btn-action{background-image:linear-gradient(to right,var(--accent1) 0,#6ab3a3 51%,var(--accent1) 100%);transition:.5s;background-size:200% auto;color:#fff}.btn-action:hover{background-position:right center}.btn-action-alt{background-image:linear-gradient(to right,#4a7879 0,var(--accent1) 51%,#4a7879 100%);transition:.5s;background-size:200% auto;color:#fff}.btn-action-alt:hover{background-position:right center}.btn-danger{background-image:linear-gradient(to right,var(--secondary) 0,#d46a67 51%,var(--secondary) 100%);transition:.5s;background-size:200% auto;color:#fff}.btn-danger:hover{background-position:right center}.loader{border:4px solid #f3f3f3;border-radius:50%;border-top:4px solid var(--accent1);width:24px;height:24px;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes card-pop-in{from{transform:scale(.95);opacity:0}to{transform:scale(1);opacity:1}}.card{animation:card-pop-in .4s ease-out forwards}.btn-refresh-animation{transition:transform .5s ease}.btn-refresh-animation.rotating{transform:rotate(360deg)}</style><body class=bg-gray-100><div id=loading-overlay class="fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50 hidden"><div class="bg-white p-4 rounded-lg flex items-center space-x-3 shadow-lg"><div class=loader></div><span>กำลังประมวลผล...</span></div></div><div id=custom-modal class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden"><div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md text-center card"><h3 id=modal-title class="text-2xl font-bold mb-4"></h3><p id=modal-message class="text-gray-600 mb-8"><div id=modal-actions class="flex justify-center gap-4"></div></div></div><header class="header-gradient text-white p-6 shadow-lg sticky top-0 z-10"><div class="container mx-auto flex justify-between items-center"><h1 class="text-3xl font-bold">Admin ควบคุมระบบคิว</h1><button id=refresh-btn class="p-2 rounded-full hover:bg-white/20 transition-colors"><svg id=refresh-icon class="h-6 w-6 btn-refresh-animation"aria-hidden=true xmlns=http://www.w3.org/2000/svg width=24 height=24 fill=none viewBox="0 0 24 24"><path stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M17.651 7.65a7.131 7.131 0 0 0-12.68 3.15M18.001 4v4h-4m-7.652 8.35a7.13 7.13 0 0 0 12.68-3.15M6 20v-4h4"/></svg></button></div></header><main class="container mx-auto p-4 md:p-8"><div class="card bg-white p-6 rounded-2xl shadow-md mb-8"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><button id=call-type-a-btn class="btn-action w-full text-xl font-bold py-4 rounded-xl shadow-lg transform hover:scale-105 duration-300">เรียกคิวทั่วไป (A)</button><button id=call-type-b-btn class="btn-action-alt w-full text-xl font-bold py-4 rounded-xl shadow-lg transform hover:scale-105 duration-300">เรียกคิวพิเศษ (B)</button><button id=reset-queue-btn class="btn-danger w-full text-xl font-bold py-4 rounded-xl shadow-lg transform hover:scale-105 duration-300 md:col-start-3">รีเซ็ตคิวทั้งหมด</button></div></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="card bg-white p-6 rounded-2xl shadow-md text-center"><h2 class="text-2xl font-semibold mb-2"style=color:var(--secondary)>กำลังเรียก</h2><p id=now-calling class="text-6xl font-black"style=color:var(--secondary)>---</div><div class="card bg-white p-6 rounded-2xl shadow-md"><div class="flex justify-between items-center mb-4"><h2 class="text-2xl font-semibold"style=color:var(--accent1)>กำลังรอ (<span id=waiting-count>0</span>)</h2></div><ul id=waiting-list class="space-y-2 max-h-96 overflow-y-auto"></ul></div><div class="card bg-white p-6 rounded-2xl shadow-md"><h2 class="text-2xl font-semibold mb-4 text-gray-500">สำเร็จ/ยกเลิกแล้ว</h2><ul id=finished-list class="space-y-2 max-h-96 overflow-y-auto"></ul></div></div></main><script>const _0x335e06=_0x2a0c;function _0x19d1(){const e=["Timestamp","button","click","serviceType","7550389GECLVr","2iCjNFo","append","SKIPPED","refresh-icon","---","className","' ที่รอเรียก","forEach","error","add","message","bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-8 rounded-lg transition-colors","appendChild","คุณแน่ใจหรือไม่ว่าต้องการล้างข้อมูลคิวทั้งหมด? การกระทำนี้ไม่สามารถย้อนกลับได้","Status","bg-gray-100 border text-gray-500 p-3 rounded-lg flex justify-between items-center opacity-70","DOMContentLoaded","action","4554TucXKM","CANCELLED","</span>","hidden","490687DHzHqA","15Lufudv","ยืนยันการรีเซ็ตคิว","Error fetching data:",'<p class="text-gray-400 text-center p-4">ยังไม่มีคิวที่เสร็จสิ้น</p>',"json","classList","call-type-b-btn","data","length","onClick","textContent",'</span><span class="text-sm font-bold ',"modal-message","3552664FbrrVF","createElement","modal-title",'<span class="font-semibold text-lg">',"success","POST","innerHTML",'<p class="text-gray-500 text-center p-4">ไม่มีคิวที่รอ</p>',"loading-overlay","addEventListener","call-type-a-btn","10Msjfxk","reset-queue-btn","Network response failed","3882375ZteVzI","classes","btn-danger py-2 px-8 rounded-lg","ยืนยัน","custom-modal","getElementById","cors","rotating","การเชื่อมต่อล้มเหลว","https://script.google.com/macros/s/AKfycbxlpGzFlrYiIanmD8hosU7R8gosy-DnMgIoxzGCjNXriBs-Eh_qCzEqJ0Arj_vV5qc2xA/exec","2330jPNgAE","801234oHJvHH","Error performing action ","finished-list","nowCalling","finishedList","application/x-www-form-urlencoded","ยกเลิก","remove","QueueNumber","onclick","waitingList","waiting-list","Network response was not ok","471160CWAXRs","reset_queue"];return(_0x19d1=function(){return e})()}!function(e,t){const n=_0x2a0c,o=_0x19d1();for(;;)try{if(324608===parseInt(n(357))/1*(parseInt(n(335))/2)+-parseInt(n(358))/3*(-parseInt(n(328))/4)+-parseInt(n(395))/5*(parseInt(n(353))/6)+-parseInt(n(385))/7+-parseInt(n(371))/8+parseInt(n(396))/9*(-parseInt(n(382))/10)+parseInt(n(334))/11)break;o.push(o.shift())}catch(e){o.push(o.shift())}}();const apiUrl=_0x335e06(394),loadingOverlay=document[_0x335e06(390)](_0x335e06(379)),callTypeABtn=document.getElementById(_0x335e06(381)),callTypeBBtn=document[_0x335e06(390)](_0x335e06(364)),resetQueueBtn=document.getElementById(_0x335e06(383)),refreshBtn=document[_0x335e06(390)]("refresh-btn"),refreshIcon=document[_0x335e06(390)](_0x335e06(338)),nowCallingEl=document[_0x335e06(390)]("now-calling"),waitingCountEl=document[_0x335e06(390)]("waiting-count"),waitingListEl=document[_0x335e06(390)](_0x335e06(407)),finishedListEl=document[_0x335e06(390)](_0x335e06(398)),modal=document.getElementById(_0x335e06(389)),modalTitle=document[_0x335e06(390)](_0x335e06(373)),modalMessage=document.getElementById(_0x335e06(370)),modalActions=document.getElementById("modal-actions");function showModal(e,t,n){const o=_0x335e06;modalTitle[o(368)]=e,modalMessage.textContent=t,modalActions[o(377)]="",n[o(342)]((e=>{const t=o,n=document[t(372)](t(331));n[t(368)]=e.text,n[t(340)]=e[t(386)],n[t(405)]=()=>{const n=t;modal[n(363)][n(344)](n(356)),e.onClick&&e[n(367)]()},modalActions[t(347)](n)})),modal[o(363)][o(403)](o(356))}function showAlert(e,t){showModal(e,t,[{text:"ตกลง",classes:"btn-action py-2 px-8 rounded-lg"}])}function showConfirm(e,t,n){const o=_0x335e06;showModal(e,t,[{text:o(388),classes:o(387),onClick:n},{text:o(402),classes:o(346)}])}function showLoading(e){loadingOverlay[_0x335e06(363)].toggle("hidden",!e)}async function performAction(e,t={}){const n=_0x335e06;showLoading(!0);try{const o=new URLSearchParams;o[n(336)](n(352),e);for(const e in t)o.append(e,t[e]);const s=await fetch(apiUrl,{method:n(376),headers:{"Content-Type":n(401)},body:o,mode:n(391)});if(!s.ok)throw new Error(n(408));const a=await s[n(362)]();if(!a[n(375)]){if(!a[n(345)].includes("No more queues"))throw new Error(a[n(345)]);showAlert("ไม่พบคิว","ไม่มีคิวประเภท '"+t[n(333)]+n(341))}return await fetchQueueData(),a}catch(t){console[n(343)](n(397)+e+":",t),showAlert("เกิดข้อผิดพลาด",t[n(345)])}finally{showLoading(!1)}}async function fetchQueueData(){const e=_0x335e06;showLoading(!0),refreshIcon[e(363)][e(344)](e(392));try{const t=await fetch(apiUrl,{mode:"cors"});if(!t.ok)throw new Error(e(384));const n=await t.json();if(!n.success)throw new Error(n[e(345)]);updateAdminUI(n[e(365)])}catch(t){console[e(343)](e(360),t),showAlert(e(393),"ไม่สามารถดึงข้อมูลคิวล่าสุดได้ กรุณาตรวจสอบการเชื่อมต่อและลองอีกครั้ง")}finally{showLoading(!1),setTimeout((()=>refreshIcon[e(363)][e(403)](e(392))),500)}}function _0x2a0c(e,t){const n=_0x19d1();return(_0x2a0c=function(e,t){return n[e-=328]})(e,t)}function updateAdminUI(e){const t=_0x335e06;nowCallingEl[t(368)]=e[t(399)]?e[t(399)].QueueNumber:t(339),waitingCountEl[t(368)]=e[t(406)][t(366)],waitingListEl.innerHTML="",e[t(406)]&&e[t(406)][t(366)]>0?e[t(406)][t(342)]((e=>{const n=t,o=document[n(372)]("li");o[n(340)]="bg-blue-50 border border-blue-200 text-blue-800 p-3 rounded-lg flex justify-between items-center",o[n(377)]=n(374)+e[n(404)]+'</span> <span class="text-sm text-gray-500">'+new Date(e[n(330)]).toLocaleTimeString("th-TH")+" น.</span>",waitingListEl[n(347)](o)})):waitingListEl[t(377)]=t(378),finishedListEl[t(377)]="",e[t(400)]&&e.finishedList[t(366)]>0?e[t(400)].reverse()[t(342)]((e=>{const n=t,o=document[n(372)]("li");o[n(340)]=n(350);let s=e[n(349)]===n(337)||e.Status===n(354)?"text-red-500":"text-green-600";o[n(377)]=n(374)+e[n(404)]+n(369)+s+'">'+e[n(349)]+n(355),finishedListEl[n(347)](o)})):finishedListEl[t(377)]=t(361)}callTypeABtn.addEventListener("click",(()=>performAction("call_next",{serviceType:"A"}))),callTypeBBtn[_0x335e06(380)](_0x335e06(332),(()=>performAction("call_next",{serviceType:"B"}))),resetQueueBtn[_0x335e06(380)](_0x335e06(332),(()=>{const e=_0x335e06;showConfirm(e(359),e(348),(()=>performAction(e(329))))})),refreshBtn[_0x335e06(380)]("click",fetchQueueData),document[_0x335e06(380)](_0x335e06(351),fetchQueueData)</script>